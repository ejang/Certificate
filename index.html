<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ========================================== -->
    <!-- [í•„ìˆ˜ ìˆ˜ì •] í˜ì´ìŠ¤ë¶/ì¹´í†¡ ê³µìœ  ì„¤ì • (Open Graph) -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ì‚¶ì„ ìœ„í•œ AI êµìœ¡ ìˆ˜ë£Œì¦ í™•ì¸" />
    <meta property="og:description" content="êµìœ¡ ê³¼ì •ì„ ì„±ê³µì ìœ¼ë¡œ ë§ˆì¹˜ì…¨ìŠµë‹ˆë‹¤. ì´ê³³ì—ì„œ ìˆ˜ë£Œì¦ì„ í™•ì¸í•˜ì„¸ìš”." />
    
    <!-- ì¤‘ìš”: ê¹ƒí—ˆë¸Œ ì´ë¯¸ì§€ ì‚¬ìš© ì‹œ ë°˜ë“œì‹œ 'Raw' ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”! -->
    <!-- ì˜ˆ: https://raw.githubusercontent.com/ì‚¬ìš©ìëª…/ì €ì¥ì†Œëª…/main/ì´ë¯¸ì§€.png -->
    <meta property="og:image" content="https://raw.githubusercontent.com/ejang/Certificate/refs/heads/main/%E1%84%89%E1%85%A1%E1%86%B1%E1%84%8B%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B1%E1%84%92%E1%85%A1%E1%86%AB%20AI%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20%E1%84%89%E1%85%AE%E1%84%85%E1%85%AD.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    
    <!-- ë°°í¬ëœ ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ ì£¼ì†Œ -->
    <meta property="og:url" content="" />
    <!-- ========================================== -->

    <title>ìˆ˜ë£Œì¦ í™•ì¸</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel (JSX ë³€í™˜ìš©) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* ì›¹í°íŠ¸: Noto Serif KR (ëª…ì¡°ì²´ ëŠë‚Œ) */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&display=swap');
        .font-serif { font-family: 'Noto Serif KR', serif; }
    </style>
</head>
<body class="bg-slate-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ì •ì˜ ---
        const IconWrapper = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const DownloadIcon = ({ className }) => (
            <IconWrapper className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" />
            </IconWrapper>
        );
        const ShareIcon = ({ className }) => (
            <IconWrapper className={className}>
                <circle cx="18" cy="5" r="3" /><circle cx="6" cy="12" r="3" /><circle cx="18" cy="19" r="3" /><line x1="8.59" x2="15.42" y1="13.51" y2="17.49" /><line x1="15.41" x2="8.59" y1="6.51" y2="10.49" />
            </IconWrapper>
        );
        const LinkIcon = ({ className }) => (
            <IconWrapper className={className}>
                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" /><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
            </IconWrapper>
        );
        const FacebookIcon = ({ className }) => (
            <IconWrapper className={className}>
                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />
            </IconWrapper>
        );
        const InstagramIcon = ({ className }) => (
            <IconWrapper className={className}>
                <rect width="20" height="20" x="2" y="2" rx="5" ry="5" /><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" /><line x1="17.5" x2="17.51" y1="6.5" y2="6.5" />
            </IconWrapper>
        );
        const CheckIcon = ({ className }) => (
            <IconWrapper className={className}>
                <polyline points="20 6 9 17 4 12" />
            </IconWrapper>
        );

        // --- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ---
        function App() {
            const [name, setName] = useState('');
            const [isLoaded, setIsLoaded] = useState(false);
            const [copySuccess, setCopySuccess] = useState(false);
            const canvasRef = useRef(null);

            const currentUrl = typeof window !== 'undefined' ? window.location.href : '';

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const nameParam = params.get('name');
                const decodedName = nameParam ? decodeURIComponent(nameParam) : 'í™ ê¸¸ ë™';
                setName(decodedName);
                setIsLoaded(true);
            }, []);

            useEffect(() => {
                if (isLoaded && name) {
                    drawCertificate();
                    setTimeout(drawCertificate, 500); 
                }
            }, [isLoaded, name]);

            const drawCertificate = () => {
                const canvas = canvasRef.current;
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                const width = canvas.width;
                const height = canvas.height;
                
                // ë°°ê²½
                ctx.fillStyle = '#fffdf5'; 
                ctx.fillRect(0, 0, width, height);

                // í…Œë‘ë¦¬
                ctx.lineWidth = 15;
                ctx.strokeStyle = '#1e3a8a';
                ctx.strokeRect(20, 20, width - 40, height - 40);
                
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#d4af37';
                ctx.strokeRect(30, 30, width - 60, height - 60);

                ctx.lineWidth = 1;
                ctx.strokeStyle = '#1e3a8a';
                ctx.strokeRect(40, 40, width - 80, height - 80);

                // í…ìŠ¤íŠ¸ ì„¤ì •
                ctx.textAlign = 'center';

                ctx.fillStyle = '#1e3a8a';
                ctx.font = 'bold 30px serif';
                ctx.fillText('CERTIFICATE', width / 2, 130);
                
                ctx.font = '16px sans-serif';
                ctx.fillStyle = '#d4af37';
                ctx.fillText('OF COMPLETION', width / 2, 160);

                ctx.fillStyle = '#111827';
                ctx.font = 'bold 50px serif';
                ctx.fillText('ìˆ˜ ë£Œ ì¦', width / 2, 240);

                ctx.font = '20px serif';
                ctx.fillStyle = '#4b5563';
                ctx.fillText('ì´ ìˆ˜ë£Œì¦ì„ ë‹¤ìŒ ë¶„ì—ê²Œ ìˆ˜ì—¬í•©ë‹ˆë‹¤', width / 2, 300);

                // ì´ë¦„
                ctx.font = 'bold 48px serif';
                ctx.fillStyle = '#1e3a8a';
                const textWidth = ctx.measureText(name).width;
                ctx.beginPath();
                ctx.moveTo(width / 2 - textWidth / 2 - 20, 380);
                ctx.lineTo(width / 2 + textWidth / 2 + 20, 380);
                ctx.strokeStyle = '#d4af37';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillText(name, width / 2, 370);

                // ë³¸ë¬¸
                ctx.font = '18px serif';
                ctx.fillStyle = '#374151';
                const lines = [
                    'ìœ„ ì‚¬ëŒì€ ììœ ìŠ¤ì½œì—ì„œ ì£¼ê´€í•˜ëŠ”',
                    'ì‚¶ì„ ìœ„í•œ AI êµìœ¡ ê³¼ì •ì„',
                    'ì„±ì‹¤íˆ ì´ìˆ˜í•˜ì˜€ìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.'
                ];
                
                lines.forEach((line, index) => {
                    ctx.fillText(line, width / 2, 460 + (index * 35));
                });

                // ë‚ ì§œ
                const today = new Date();
                const dateStr = `${today.getFullYear()}. ${today.getMonth() + 1}. ${today.getDate()}`;
                ctx.font = '18px serif';
                ctx.fillStyle = '#6b7280';
                ctx.fillText(dateStr, width / 2, 600);

                // ì„œëª…
                ctx.font = 'bold 24px serif';
                ctx.fillStyle = '#111827';
                ctx.fillText('ììœ ìŠ¤ì½œë ˆ', width / 2 - 30, 680);

                // ë„ì¥
                ctx.save();
                ctx.translate(width / 2 + 100, 670);
                ctx.rotate(-15 * Math.PI / 180);
                ctx.beginPath();
                ctx.arc(0, 0, 30, 0, Math.PI * 2);
                ctx.strokeStyle = '#dc2626';
                ctx.lineWidth = 3;
                ctx.stroke();
                ctx.font = '14px serif';
                ctx.fillStyle = '#dc2626';
                ctx.fillText('ì¸', 0, 5);
                ctx.restore();
            };

            const handleDownload = () => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const link = document.createElement('a');
                link.download = `${name}_certificate.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            };

            // í˜ì´ìŠ¤ë¶ ê³µìœ  ì‹œ ì•ˆë‚´ ì¶”ê°€ (ë§í¬ ê³µìœ  vs ì´ë¯¸ì§€ ì—…ë¡œë“œ)
            const handleFacebookShare = () => {
                const confirmUpload = window.confirm(
                    "í˜ì´ìŠ¤ë¶ì— ê³µìœ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n[í™•ì¸]: ë§í¬ë§Œ ê³µìœ í•©ë‹ˆë‹¤ (ê³µí†µ ì´ë¯¸ì§€ê°€ ë³´ì„)\n[ì·¨ì†Œ]: ë‚´ ìˆ˜ë£Œì¦ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ì—¬ ì§ì ‘ ì˜¬ë¦½ë‹ˆë‹¤ (ì¶”ì²œ)"
                );

                if (confirmUpload) {
                    const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}`;
                    window.open(shareUrl, '_blank');
                } else {
                    handleDownload();
                    alert("ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\ní˜ì´ìŠ¤ë¶ ì•±ì„ ì—´ì–´ ì €ì¥ëœ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”!");
                }
            };

            const handleInstagramShare = () => {
                handleDownload();
                alert("ì¸ìŠ¤íƒ€ê·¸ë¨ì€ ì´ë¯¸ì§€ ì§ì ‘ ì—…ë¡œë“œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ì¸ìŠ¤íƒ€ê·¸ë¨ ì•±ì—ì„œ ê³µìœ í•´ì£¼ì„¸ìš”!");
            };

            const handleCopyLink = () => {
                navigator.clipboard.writeText(currentUrl).then(() => {
                    setCopySuccess(true);
                    setTimeout(() => setCopySuccess(false), 2000);
                });
            };

            const handleNativeShare = async () => {
                if (navigator.share) {
                    try {
                        const canvas = canvasRef.current;
                        const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                        const file = new File([blob], 'certificate.png', { type: 'image/png' });

                        await navigator.share({
                            title: `${name}ë‹˜ì˜ ìˆ˜ë£Œì¦`,
                            text: 'ìˆ˜ë£Œì¦ì„ í™•ì¸í•´ë³´ì„¸ìš”!',
                            files: [file],
                        });
                    } catch (err) {
                        console.log('ê³µìœ  ì·¨ì†Œ ë˜ëŠ” ì—ëŸ¬:', err);
                    }
                } else {
                    handleCopyLink();
                }
            };

            if (!isLoaded) return <div className="min-h-screen flex items-center justify-center">Loading...</div>;

            return (
                <div className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 font-sans">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-10">
                            <h1 className="text-3xl font-bold text-slate-900 mb-2">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! {name}ë‹˜</h1>
                            <p className="text-slate-600">ì‚¶ì„ ìœ„í•œ AI êµìœ¡ ê³¼ì •ì„ ì„±ê³µì ìœ¼ë¡œ ë§ˆì¹˜ì…¨ìŠµë‹ˆë‹¤. ì¸ì¦ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                        </div>

                        <div className="bg-white rounded-2xl shadow-xl overflow-hidden md:flex md:flex-row-reverse">
                            <div className="md:w-1/3 bg-slate-50 p-8 border-l border-slate-200 flex flex-col justify-center space-y-6">
                                <div className="text-center md:text-left mb-4">
                                    <h3 className="text-lg font-semibold text-slate-800">ê³µìœ  ë° ì €ì¥</h3>
                                    <p className="text-sm text-slate-500">ì¸ì¦ì„œë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì¹œêµ¬ë“¤ì—ê²Œ ìë‘í•´ë³´ì„¸ìš”.</p>
                                </div>

                                <button onClick={handleDownload} className="w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-xl font-bold transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
                                    <DownloadIcon className="w-5 h-5" />
                                    ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                                </button>

                                <div className="grid grid-cols-2 gap-3 pt-4 border-t border-slate-200">
                                    <button onClick={handleFacebookShare} className="flex flex-col items-center justify-center gap-1 p-3 bg-white border border-slate-200 rounded-xl hover:bg-blue-50 hover:border-blue-200 hover:text-blue-600 transition-colors">
                                        <FacebookIcon className="w-6 h-6 text-blue-600" />
                                        <span className="text-xs font-medium">í˜ì´ìŠ¤ë¶</span>
                                    </button>
                                    <button onClick={handleInstagramShare} className="flex flex-col items-center justify-center gap-1 p-3 bg-white border border-slate-200 rounded-xl hover:bg-pink-50 hover:border-pink-200 hover:text-pink-600 transition-colors">
                                        <InstagramIcon className="w-6 h-6 text-pink-600" />
                                        <span className="text-xs font-medium">ì¸ìŠ¤íƒ€ê·¸ë¨</span>
                                    </button>
                                </div>

                                <div className="space-y-3">
                                    {typeof navigator !== 'undefined' && navigator.share && (
                                        <button onClick={handleNativeShare} className="w-full flex items-center justify-center gap-2 bg-slate-800 text-white py-2.5 px-4 rounded-lg text-sm font-medium hover:bg-slate-700 transition-colors">
                                            <ShareIcon className="w-4 h-4" />
                                            ê³µìœ í•˜ê¸° (ëª¨ë°”ì¼)
                                        </button>
                                    )}
                                    <button onClick={handleCopyLink} className="w-full flex items-center justify-center gap-2 bg-white border border-slate-300 text-slate-700 py-2.5 px-4 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors">
                                        {copySuccess ? <CheckIcon className="w-4 h-4 text-green-600" /> : <LinkIcon className="w-4 h-4" />}
                                        {copySuccess ? 'ë³µì‚¬ ì™„ë£Œ!' : 'ë§í¬ ë³µì‚¬'}
                                    </button>
                                </div>
                            </div>

                            <div className="md:w-2/3 p-8 bg-slate-200 flex items-center justify-center">
                                <div className="relative shadow-2xl">
                                    <canvas ref={canvasRef} width={600} height={800} className="bg-white max-w-full h-auto rounded-sm block" style={{ maxHeight: '70vh' }} />
                                </div>
                            </div>
                        </div>
                        <div className="mt-8 text-center text-slate-400 text-sm">
                            &copy; 2025 ììœ ìŠ¤ì½œë ˆ. All rights reserved.
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
